---
term: フィー・スナイピング
---
マイナーが最近確認されたブロックを書き換えて、そのブロックに含まれる取引手数料を請求しようとする攻撃シナリオ。この攻撃の最終的な目的は、マイナーの収益性を高めることである。ブロック報酬が減少し、取引手数料がマイナーの収益の大部分を占めるようになると、手数料スナイピングはますます収益性が高まる可能性がある。また、前のブロックに含まれる手数料が次の最良候補ブロックに含まれる手数料よりも大幅に高い場合にも有利になる。単純化すると、マイナーはインセンティブという観点からこのような選択を迫られる：


- 最後のブロックに続いて普通に採掘し、高確率で低報酬を獲得する；
- 低確率で高額報酬を獲得できる、前のブロックの採掘（フィー・スナイピング）を試みる。

この攻撃を採用するマイナーが増えれば増えるほど、最初は正直であった他のマイナーも同じことをするインセンティブが働くため、この攻撃はビットコインのシステムにリスクをもたらす。実際、フィー・スナイピングを試みるマイナーに新しいマイナーが加わるたびに、攻撃するマイナーの1人が成功する確率が高まり、その代わり、正直なマイナーの1人がチェーンを延長する確率が低下する。この攻撃が大量に実行され、長期にわたって継続された場合、ブロック確認はビットコイン取引の不変性を示す信頼できる指標ではなくなる。これにより、システムが使用不能になる可能性がある。

このリスクに対抗するため、ほとんどのウォレットソフトウェアはトランザクションの検証を次のブロックの高さに含めることを条件とするように、`nLocktime`フィールドを自動的に埋める。従って、その取引を前のブロックの書き換えに含めることは不可能になる。もし`nLocktime`の使用がビットコインユーザーに広く採用されれば、手数料のスナイピングのインセンティブが著しく低下する。実際、書き換えによる潜在的利益を減らすことで、書き換えよりもむしろブロックチェーンの進行を促すことになる。Taprootトランザクションについて、BIP326は`nSequence`フィールドを同様の方法で使用し、他のタイプのトランザクションの`nLocktime`フィールドと同等の効果を達成することを提案している。この使い方は、同じフィールドを使用する第2層のプロトコルのプライバシーも改善することになり、一石二鳥である。