---
用語アダプター署名

---
真正な署名と追加の署名（「アダプター署名」と呼ばれる）を組み合わせることで、秘密のデータを明らかにすることができる暗号手法。この方法は、有効な署名、アダプター署名、秘密のうち2つの要素を知ることで、欠けている3つ目の要素を推測することができるという仕組みになっている。この方法の興味深い特性の1つは、相手のアダプタ署名と、このアダプタ署名を計算するために使用された秘密にリンクされた楕円曲線上の特定の点を知っていれば、秘密自体に直接アクセスすることなく、同じ秘密と一致する自分自身のアダプタ署名を導き出すことができるということである。お互いを信用していない2つの利害関係者間の交換において、このテクニックは、参加者間で2つの機密情報を同時に公開することを可能にする。このプロセスにより、コインスワップやアトミックスワップのような瞬間的な取引における信頼の必要性がなくなる。よりよく理解するために例を挙げてみよう。アリスとボブはお互いに1BTCを送りたいが、お互いを信用していない。そのため、彼らはこの交換において相手に対する信頼の必要性を否定するためにアダプター署名を使用する（したがって、これは「アトミック」交換となる）。彼らは次のように進める：


- アリスがこのアトミック交換を開始する。彼女は1BTCをBobに送るトランザクション$m_A$を作成する。アリスは自分の秘密鍵$p_A$($P_A = p_A \cdot G$)と、ノンス$n_A$と秘密$t$($N_A = n_A \cdot G$と$T = t \cdot G$)を使って、この取引を検証する署名$s_A$を作成する：

s_A = n_A + t + H(N_A + T ︓平行 P_A ︓平行 m_A) ︓cdot p_A$$.

(゜Д゜)・゜・；


- アリスは秘密$t$と実署名$s_A$からアダプタ署名$s_A'$を計算する：

s_A' = s_A - t$$.

(゜Д゜)・゜・；


- アリスはボブに、自分のアダプタ署名$s_A'$、署名なしトランザクション$m_A$、 秘密$T$に対応する点、ノンス$N_A$に対応する点を送る。これらの情報を「アダプタ」と呼ぶ。この情報だけでは、ボブはアリスのBTCを復元できない。
- しかし、ボブはアリスが自分を欺いていないことを検証できる。そのためには、アリスのアダプタ署名 $s_A'$ が約束されたトランザクション $m_A$ と一致するかどうかをチェックする。もし次の式が正しければ、彼はアリスのアダプタ署名が有効であると確信する：

s_A'  \cdot G = N_A + H(N_A + T ﹑平行 P_A ﹑平行 m_A) ﹑cdot P_A$$.

(゜Д゜)・゜・；


- この検証により、ボブはアリスからの保証を得ることができ、安心してアトミックスワッププロセスを続けることができる。次に彼は、アリスに1BTCを送る彼自身のトランザクション$m_B$と、アリスだけが知っている同じ秘密$t$とリンクされた彼自身のアダプタ署名$s_B'$を作成する（ボブはこの値$t$を知らないが、アリスが彼に提供した対応する点$T$だけを知っている）：s_B' = n_B + H(N_B + T ︓パラレルP_B ︓パラレルm_B)︓cdot p_B$.

(゜Д゜)・゜・；


- ボブは自分のアダプタ署名$s_B'$、署名なしのトランザクション$m_B$、 秘密$T$に対応する点、およびノンス$N_B$に対応する点をアリスに送る。アリスはボブのアダプタ署名$s_B'$と自分だけが知っている秘密$t$を組み合わせて、ボブのBTCを送るトランザクション$m_B$の有効な署名$s_B$を計算できる：

s_B = s_B' + t$$.

(゜Д゜)・゜・；

(s_B' + t)  \cdot G = N_B + T + H(N_B + T  \parallel P_B ¤parallel m_B) ¤parallel P_B$$ ¤̴̶̷̀ω¤̴̶̷́)

(゜Д゜)・゜・；


- AliceはBobが約束したBTCを回収するために、この署名された取引$m_B$をBitcoinブロックチェーン上にブロードキャストする。ボブはブロックチェーン上でこの取引を知る。こうして彼は署名$s_B = s_B' + t$を抽出することができる。この情報から、ボブは自分が必要としていた有名な秘密$t$を分離することができる：

t = (s_B' + t) - s_B' = s_B - s_B'$$.

(゜Д゜)・゜・；


- しかし、この秘密$t$は、ボブがアリスのアダプタ署名$s_A'$から有効な署名$s_A$を生成するために欠けている唯一の情報であり、これによってアリスからボブにBTCを送るトランザクション$m_A$を検証することができる。そして$s_A$を計算し、取引$m_A$を順番にブロードキャストする。

(゜Д゜)・゜・；

(s_A' + t)  \cdot G = N_A + T + H(N_A + T  \parallel P_A  \parallel m_A)  \cdot P_A$$.